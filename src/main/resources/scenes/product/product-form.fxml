<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import org.kordamp.ikonli.javafx.FontIcon?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>

<BorderPane xmlns="http://javafx.com/javafx/18" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="ashu.sah.SahPustakSadan.Front_end.Controller.Product.ProductFormController"
            styleClass="main_container">

    <!-- Header Section -->
    <top>
        <VBox styleClass="page_header" spacing="15">
            <!-- Navigation Header -->
            <HBox styleClass="nav_header" alignment="CENTER_LEFT" spacing="15">
                <Button fx:id="backButton" text="← Back to Products" styleClass="nav_back_btn"
                        onAction="#handleBack" />
                <Separator orientation="VERTICAL" />
                <FontIcon iconLiteral="fas-shopping-cart" iconSize="24" styleClass="header_icon" />
                <Text fx:id="formTitle" text="Add New Product" styleClass="page_title" />
            </HBox>

            <!-- Breadcrumb -->
            <HBox styleClass="breadcrumb" spacing="5" alignment="CENTER_LEFT">
                <Label text="Products" styleClass="breadcrumb_item" />
                <Label text=">" styleClass="breadcrumb_separator" />
                <Label text="Add Product" styleClass="breadcrumb_current" />
            </HBox>
        </VBox>
    </top>

    <!-- Main Content -->
    <center>
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" VBox.vgrow="ALWAYS"
                    styleClass="form_scroll_pane">
            <VBox spacing="25" styleClass="form_container" maxWidth="800">

                <!-- Basic Information Section -->
                <VBox spacing="15" styleClass="form_section">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fas-info-circle" iconSize="18" styleClass="section_icon" />
                        <Text text="Basic Information" styleClass="section_header" />
                    </HBox>

                    <GridPane hgap="20" vgap="15" styleClass="form_grid">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="140" prefWidth="140" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                            <ColumnConstraints hgrow="NEVER" minWidth="140" prefWidth="140" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                        </columnConstraints>

                        <!-- Row 1: Product Code & Name -->
                        <Label text="Product Code *" GridPane.columnIndex="0" GridPane.rowIndex="0"
                               styleClass="form_label" />
                        <TextField fx:id="codeField" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                   styleClass="form_field" promptText="Enter unique product code" />

                        <Label text="Product Name *" GridPane.columnIndex="2" GridPane.rowIndex="0"
                               styleClass="form_label" />
                        <TextField fx:id="nameField" GridPane.columnIndex="3" GridPane.rowIndex="0"
                                   styleClass="form_field" promptText="Enter product name" />

                        <!-- Row 2: Category & Unit -->
                        <Label text="Category *" GridPane.columnIndex="0" GridPane.rowIndex="1"
                               styleClass="form_label" />
                        <ComboBox fx:id="categoryCombo" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                  styleClass="form_field" promptText="Select category" maxWidth="Infinity" />

                        <Label text="Unit *" GridPane.columnIndex="2" GridPane.rowIndex="1"
                               styleClass="form_label" />
                        <ComboBox fx:id="unitCombo" GridPane.columnIndex="3" GridPane.rowIndex="1"
                                  styleClass="form_field" promptText="Select unit" maxWidth="Infinity"
                                  onAction="#handleSelectUnit">
                            <items>
                                <FXCollections fx:factory="observableArrayList">
                                    <String fx:value="Piece" />
                                    <String fx:value="Kg" />
                                    <String fx:value="Liter" />
                                    <String fx:value="Meter" />
                                    <String fx:value="Box" />
                                    <String fx:value="Pack" />
                                </FXCollections>
                            </items>
                        </ComboBox>

                        <!-- Row 3: Barcode & Status -->
                        <Label text="Barcode" GridPane.columnIndex="0" GridPane.rowIndex="2"
                               styleClass="form_label" />
                        <TextField fx:id="barcodeField" GridPane.columnIndex="1" GridPane.rowIndex="2"
                                   styleClass="form_field" promptText="Enter barcode (optional)" />

                        <Label text="Status" GridPane.columnIndex="2" GridPane.rowIndex="2"
                               styleClass="form_label" />
                        <CheckBox fx:id="activeCheckBox" text="Active Product" GridPane.columnIndex="3" GridPane.rowIndex="2"
                                  styleClass="form_checkbox" selected="true" />
                    </GridPane>
                </VBox>

                <!-- Pricing Information Section -->
                <VBox spacing="15" styleClass="form_section">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fas-dollar-sign" iconSize="18" styleClass="section_icon" />
                        <Text text="Pricing Information" styleClass="section_header" />
                    </HBox>

                    <GridPane hgap="20" vgap="15" styleClass="form_grid">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="140" prefWidth="140" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                            <ColumnConstraints hgrow="NEVER" minWidth="140" prefWidth="140" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                        </columnConstraints>

                        <!-- Row 1: Cost Price & Base Price -->
                        <Label text="Cost Price *" GridPane.columnIndex="0" GridPane.rowIndex="0"
                               styleClass="form_label" />
                        <HBox GridPane.columnIndex="1" GridPane.rowIndex="0" spacing="5" alignment="CENTER_LEFT">
                            <Label text="₹" styleClass="currency_symbol" />
                            <TextField fx:id="costPriceField" styleClass="form_field" promptText="0.00"
                                       HBox.hgrow="ALWAYS" />
                        </HBox>

                        <Label text="Base Price *" GridPane.columnIndex="2" GridPane.rowIndex="0"
                               styleClass="form_label" />
                        <HBox GridPane.columnIndex="3" GridPane.rowIndex="0" spacing="5" alignment="CENTER_LEFT">
                            <Label text="₹" styleClass="currency_symbol" />
                            <TextField fx:id="basePriceField" styleClass="form_field" promptText="0.00"
                                       HBox.hgrow="ALWAYS" />
                        </HBox>

                        <!-- Row 2: Tax Percentage & Profit Margin -->
                        <Label text="Tax %" GridPane.columnIndex="0" GridPane.rowIndex="1"
                               styleClass="form_label" />
                        <HBox GridPane.columnIndex="1" GridPane.rowIndex="1" spacing="5" alignment="CENTER_LEFT">
                            <TextField fx:id="taxPercentageField" styleClass="form_field" promptText="0.00"
                                       text="0.00" HBox.hgrow="ALWAYS" />
                            <Label text="%" styleClass="currency_symbol" />
                        </HBox>

                        <Label text="Profit Margin" GridPane.columnIndex="2" GridPane.rowIndex="1"
                               styleClass="form_label" />
                        <HBox GridPane.columnIndex="3" GridPane.rowIndex="1" alignment="CENTER_LEFT"
                              styleClass="profit_display">
                            <Label fx:id="profitMarginLabel" text="₹0.00 (0%)" styleClass="profit_value" />
                        </HBox>
                    </GridPane>
                </VBox>

                <!-- Inventory Information Section -->
                <VBox spacing="15" styleClass="form_section">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fas-boxes" iconSize="18" styleClass="section_icon" />
                        <Text text="Inventory Information" styleClass="section_header" />
                    </HBox>

                    <GridPane hgap="20" vgap="15" styleClass="form_grid">
                        <columnConstraints>
                            <ColumnConstraints hgrow="NEVER" minWidth="140" prefWidth="140" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                            <ColumnConstraints hgrow="NEVER" minWidth="140" prefWidth="140" />
                            <ColumnConstraints hgrow="ALWAYS" minWidth="200" />
                        </columnConstraints>

                        <!-- Row 1: Min Stock & Initial Stock -->
                        <Label text="Min Stock Level *" GridPane.columnIndex="0" GridPane.rowIndex="0"
                               styleClass="form_label" />
                        <TextField fx:id="minStockField" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                   styleClass="form_field" promptText="0" text="0" />

                        <Label text="Initial Stock" GridPane.columnIndex="2" GridPane.rowIndex="0"
                               styleClass="form_label" />
                        <TextField fx:id="initialStockField" GridPane.columnIndex="3" GridPane.rowIndex="0"
                                   styleClass="form_field" promptText="0" text="0" />
                    </GridPane>
                </VBox>

                <!-- Description Section -->
                <VBox spacing="15" styleClass="form_section">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fas-align-left" iconSize="18" styleClass="section_icon" />
                        <Text text="Product Description" styleClass="section_header" />
                    </HBox>

                    <TextArea fx:id="descriptionArea" styleClass="form_textarea"
                              promptText="Enter detailed product description (optional)"
                              prefRowCount="4" wrapText="true" />
                </VBox>

            </VBox>
        </ScrollPane>
    </center>

    <!-- Footer with Action Buttons -->
    <bottom>
        <HBox styleClass="form_footer" spacing="15" alignment="CENTER_RIGHT" padding="20">
            <Region HBox.hgrow="ALWAYS" />

            <!-- Action Buttons -->
            <Button fx:id="cancelButton" text="Cancel" styleClass="secondary_btn"
                    onAction="#handleCancel" prefWidth="100">
                <graphic>
                    <FontIcon iconLiteral="fas-times" iconSize="16" />
                </graphic>
            </Button>

            <Button fx:id="saveButton" text="Save Product" styleClass="primary_btn"
                    onAction="#handleSave" prefWidth="120">
                <graphic>
                    <FontIcon iconLiteral="fas-save" iconSize="16" />
                </graphic>
            </Button>
        </HBox>
    </bottom>

</BorderPane>